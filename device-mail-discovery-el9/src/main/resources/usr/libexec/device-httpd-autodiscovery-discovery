#!/bin/bash
  
if [ $# -eq 2 ]; then

  instance="${1}"
  line="${2}"

  cat > "device-${instance}-discovery.conf" <<- EOF
# Generated by $0 on `date`
# DO NOT MODIFY THIS FILE - it will be overwritten on server restart.
#

<IfModule !autodiscover_module>
  LoadModule autodiscover_module /usr/lib64/httpd/modules/mod_autodiscover.so
</IfModule>
<IfModule !include_module>
  LoadModule include_module /usr/lib64/httpd/modules/mod_include.so
</IfModule>
<IfModule !ldap_module>
  LoadModule ldap_module /usr/lib64/httpd/modules/mod_ldap.so
</IfModule>
<IfModule !meta_ldap_module>
  LoadModule meta_ldap_module /usr/lib64/httpd/modules/mod_meta_ldap.so
</IfModule>

EOF

  install -m 640 "device-${instance}-discovery.conf" "/etc/httpd/conf.device.d/instance/${instance}"/discovery.conf

fi


